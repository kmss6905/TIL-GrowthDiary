# 2. System Structure & Program Execution 1

![α„‰α…³α„α…³α„…α…µα†«α„‰α…£α†Ί 2023-06-19 α„‹α…©α„’α…® 2.09.22.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/d721a147-ff17-4f66-9d66-b75e14a8939a/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-06-19_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.09.22.png)

![α„‰α…³α„α…³α„…α…µα†«α„‰α…£α†Ί 2023-06-19 α„‹α…©α„’α…® 2.12.57.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/b7a9e5c8-2a15-4f5e-9bdd-654197b26228/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-06-19_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.12.57.png)

## CPU

CPU λ” μ΄λ²μ— μ‹¤ν–‰ν•΄μ•Ό λ  μΈμ¤νΈλ­μ…μ λ©”λ¨λ¦¬ μ£Όμ†λ¥Ό register μ¤‘μ—μ„ program couter(pc) register κ°€ κ°€μ§€κ³  μμ. λ§¤λ² ν•΄λ‹Ή instraction λ§ μ‹¤ν–‰ν•λ” κ²ƒ. κ·Έλ¦¬κ³  κ·Έλ° μΈμ¤νΈλ­μ… μ¤‘μ—μ„ io μ¥μΉλ¥Ό μ ‘κ·Όν•λ” μƒν™©μ΄ λλ©΄ λ””μ¤ν¬ λ“λΌμ΄λ²„λ¥Ό ν†µν•΄μ„ cpuκ°€ μ¥μΉμ—κ² μ½μ–΄, μ“°λΌκ³  ν•λ” λ…λ Ήμ„ ν•κ² λ¨. μ¦‰, CPUλ” λ©”λ¨λ¦¬μ— μλ” instruction μ§€μ‹λ¥Ό λ°›μ•„μ„ μΌμ„ ν•  λΏμ΄λ‹¤. 

timer : νΉμ • ν”„λ΅κ·Έλ¨μ΄ cpu λ¥Ό λ§‰κΈ° μ„ν• κ²ƒ. μ‚¬μ©μν”„λ΅κ·Έλ¨μ„ cpuμ— λ„κ²¨μ¤„ λ• timer λ¥Ό μ„Έν…ν•΄λ†“μ. cpu λ” ν•λ‚μ μ—°μ‚°μ„ μ‹¤ν–‰ ν›„ interuptline μ²΄ν¬ν•¨. timer κ°€ μΈν„°λ½νΈλ¥Ό κ±Έμ–΄μ¤λ©΄ cpuλ” ν•λμΌμ„ λ©μ¶”κ³ , cpuμ μ μ–΄κ¶μ„ μ‚¬μ©μ ν”„λ΅κ·Έλ¨μ—μ„ μ΄μμ²΄μ λ΅ μλ™μΌλ΅ λ„μ–΄κ°„λ‹¤.

### Mode bit

![α„‰α…³α„α…³α„…α…µα†«α„‰α…£α†Ί 2023-06-19 α„‹α…©α„’α…® 2.31.10.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/55ab6223-9557-4529-a23a-aaed845402bf/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-06-19_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.31.10.png)

- μ‚¬μ©μ ν”„λ΅κ·Έλ¨μ μλ»λ μν–‰μΌλ΅ λ‹¤λ¥Έ ν”„λ΅κ·Έλ¨ λ° μ΄μμ²΄μ μ— ν”Όν•΄κ°€ κ°€μ§€ μ•λ„λ΅ ν•κΈ° μ„ν• λ³΄νΈ μ¥μΉ ν•„μ”
- Mode bit μ„ ν†µν•΄ ν•λ“μ›¨μ–΄μ μΌλ΅ λ‘ κ°€μ§€ λ¨λ“μ operation μ§€μ›
    - 1 : μ‚¬μ©μ λ¨λ“ : μ‚¬μ©μ ν”„λ΅κ·Έλ¨ μν–‰
    - 0 : λ¨λ‹ν„° λ¨λ“(μ»¤λ„λ¨λ“) : OS μ½”λ“ μν–‰
    - λ³΄μ•μ„ ν•΄μΉ  μ μλ” μ¤‘μ”ν• λ…λ Ήμ–΄λ” λ¨λ‹ν„° λ¨λ“μ—μ„λ§ μν–‰κ°€λ¥ν• β€νΉκ¶λ…λ Ήβ€μΌλ΅ κ·μ •
    - Interrupt λ‚ Exception λ°μƒμ‹ ν•λ“μ›¨μ–΄κ°€ mode bit μ„ 0μΌλ΅ λ°”κΏ
    - μ‚¬μ©μ ν”„λ΅κ·Έλ¨μ—κ² CPUλ¥Ό λ„κΈ°κΈ° μ „μ— mode bitμ„ 1λ΅ μ…‹ν…

### Timer

- νƒ€μ΄λ¨Έ
    - μ •ν•΄μ§„ μ‹κ°„μ΄ νλ¥Έ λ’¤ μ΄μμ²΄μ μ—κ² μ μ–΄κ¶μ΄ λ„μ–΄κ°€λ„λ΅ μΈν„°λ½νΈλ¥Ό λ°μƒμ‹ν‚΄
    - νƒ€μ΄λ¨Έλ” λ§¤ ν΄λ­ ν‹± λ•λ§λ‹¤ 1μ”© κ°μ†
    - νƒ€μ΄λ¨Έ κ°’μ΄ 0μ΄ λλ©΄ νƒ€μ΄λ¨Έ μΈν„°λ½νΈ λ°μƒ
    - CPUλ¥Ό νΉμ • ν”„λ΅κ·Έλ¨μ΄ λ…μ ν•λ” κ²ƒμΌλ΅λ¶€ν„° λ³΄νΈ
- νƒ€μ΄λ¨Έλ” timesharing μ„ κµ¬ν„ν•κΈ° μ„ν•΄ λ„λ¦¬ μ΄μ© λ¨
- νƒ€μ΄λ¨Έλ” ν„μ¬ μ‹κ°„μ„ κ³„μ‚°ν•κΈ° μ„ν•΄μ„λ„ μ‚¬μ©

### Device Controller

- I/O Device Controller
    - ν•΄λ‹Ή I/O μ¥μΉμ ν•μ„ κ΄€λ¦¬ν•λ” μΌμΆ…μ μ‘μ€ CPU
    - μ μ–΄ μ •λ³΄λ¥Ό μ„ν•΄ control register, status registerλ¥Ό κ°€μ§
    - local buffer λ¥Ό κ°€μ§ (μΌμΆ…μ data register) β†’ μ΄λ¥Ό ν†µν•΄ λ°μ΄ν„°λ¥Ό κ°€μ§
        - ν›„μ— memory λ΅ λ°μ΄ν„°λ΅ λ„κΉ€
        - cpu λ” λ©”μΈλ©”λ¨λ¦¬, local buffer λ΅ μ ‘κ·Ό κ°€λ¥
- I/Oλ” μ‹¤μ  device μ™€ local buffer μ‚¬μ΄μ—μ„ μΌμ–΄λ‚¨
- Device Controller λ” I/O κ°€ λλ‚¬μ„ κ²½μ° **interrupt** λ΅ CPU μ— κ·Έ μ‚¬μ‹¤μ„ μ•λ¦Ό

<aside>
π—¨οΈ device driver(μ¥μΉκµ¬λ™κΈ°) 
: OS μ½”λ“ μ¤‘ κ° μ¥μΉλ³„ μ²λ¦¬ λ£¨ν… β†’ software

</aside>

<aside>
π—¨οΈ device controller(μ¥μΉμ μ–΄κΈ°)
: κ° μ¥μΉλ¥Ό ν†µμ ν•λ” μΌμΆ…μ μ‘μ€ CPU β†’ hardware

</aside>

cpu κ°€ μΈν„°λ½νΈλ¥Ό λ„λ¬΄ λ§μ΄ λ‹Ήν•  μ μλ‹¤.

λ­”κ°€ μΈν’‹ ν•λ‚ λ“¤μ–΄μ¤λ©΄ β†’ interupt κ±Έμ–΄λ²„λ¦Ό β†’ cpuλ” os λ΅ λ„μ–΄κ°€μ„ β†’ cpu λ” local buffer λ΅ λ¶€ν„° λ°μ΄ν„°λ¥Ό λ©”λ¨λ¦¬λ΅ μΉ΄ν”Όν•΄μ„ κ°€μ Έμ¨ ν›„ β†’ β€¦ λ°λ³µ

κ·Έλμ„ DAM controller(Direct Access Controller) λΌλ” κ²ƒμ„ ν•λ‚ λ” λ‘κ³  μλ‹¤.

### DAMController

DAM Controllerλ” DMA(Direct Memory Access) κΈ°μ μ„ μ΄μ©ν•μ—¬ CPU λ€μ‹ μ— μ£Όλ³€μ¥μΉμ™€ λ©”λ¨λ¦¬κ°„μ λ°μ΄ν„° μ „μ†΅μ„ μν–‰ν•λ” μ¥μΉμ΄λ‹¤. μ΄λ¥Ό ν†µν•΄ CPUκ°€ μΌμ„ ν•μ§€ μ•μ•„λ„ λ°μ΄ν„°λ¥Ό μ£Όκ³  λ°›μ„ μ μκΈ° λ•λ¬Έμ—, ν¨μ¨μ μΈ λ°μ΄ν„° μ „μ†΅μ΄ κ°€λ¥ν•λ‹¤. λ”°λΌμ„ μΈν„°λ½νΈλ¥Ό μΌμΌν‚¤μ§€ μ•κ³ , ν¨μ¨μ μ΄κ³  λΉ λ¥Έ λ°μ΄ν„° μ „μ†΅μ΄ κ°€λ¥ν•λ‹¤.

## μ…μ¶λ ¥(I/O)μ μν–‰

- λ¨λ“  μ…μ¶λ ¥ λ…λ Ήμ€ νΉκ¶ λ…λ Ή(μ¦‰, μ΄μμ²΄μ λ¥Ό ν†µν•΄μ„λ§ I/O μ¥μΉμ— μ ‘κ·Όν•  μ μλ‹¤.)
- μ‚¬μ©μ ν”„λ΅κ·Έλ¨μ€ μ–΄λ–»κ² I/Oλ¥Ό ν•λ” κ°€?
    - μ‹μ¤ν… μ½(system call)
        - μ‚¬μ©μ ν”„λ΅κ·Έλ¨μ€ μ΄μμ²΄μ μ—κ² I/O μ”μ²­
        - μ¦‰, μ‚¬μ©μ ν”„λ΅κ·Έλ¨μ΄ μ΄μμ²΄μ μ μ»¤λ„ ν•¨μλ¥Ό νΈμ¶
            - μ΄κ±΄ μΌλ°μ μΈ ν•¨μλ‘ μΆ€ λ‹¤λ¦„
            - (μ¤‘μ”) λ‚΄ ν”„λ΅κ·Έλ¨μ•μ—μ„ ν•¨μ νΈμ¶ν•λ” κ²ƒμ€ μƒκ΄€μ—†μ§€λ§, μ‹¤ν–‰λλ‹¤κ°€ I/O μ”μ²­μ„ ν•κΈ° μ„ν•΄μ„ μ΄μμ²΄μ  ν•¨μλ¥Ό νΈμ¶ ν•λ” κ²ƒμ€, κ·Έλƒ¥ λ©”λ¨λ¦¬ μ£Όμ†λ¥Ό λ°”κΏ”μ„ λλ” μΌμ€   μ•„λ‹. λ³µμ΅ν•¨. ν„μ¬ mode bit μ΄ 1λ΅ λμ–΄μμ. κ·Έλ ‡λ‹¤λ©΄ I/Oλ¥Ό ν•κΈ° μ„ν•΄μ„ OS μ£Όμ†λ΅ λ„μ–΄κ°€μ•Ό ν•λ‹¤.
                - timer , I/O controller κ°€ interrupt κ±°λ” κ²ƒμ΄ μ•„λ‹ ν”„λ΅κ·Έλ¨μ΄ μ΄μμ²΄μ μ—κ² λ¬΄μ–Έκ°€λ¥Ό μ”μ²­ν•κΈ° μ„ν•΄ μ†ν”„νΈμ›¨μ–΄ μ μΌλ΅ μ§μ ‘ interrupt λ¥Ό κ±Έ μ μλ‹¤.(=μ†ν”„νΈμ›¨μ–΄ μΈν„°λ½νΈ, Trap) β†’ μ΄λ¥Ό ν†µν•΄ OS μ modebit μ΄ 0μΌλ΅ λ°”λ€
    - trap μ„ μ‚¬μ©ν•μ—¬ μΈν„°λ½νΈ λ²΅ν„°μ νΉμ • μ„μΉλ΅ μ΄λ™
    - μ μ–΄κ¶μ΄ μΈν„°λ½νΈ λ²΅ν„°κ°€ κΈ°λ¦¬ν‚¤λ” μΈν„°λ½νΈ μ„λΉ„μ¤ λ£¨ν‹΄μΌλ΅ μ΄λ™
    - μ¬λ°”λ¥Έ I/O μ”μ²­μΈμ§€ ν™•μΈ ν›„ I/O μν–‰(νμΌμ΄λΌλ©΄, ν•΄λ‹Ή νμΌμ— μ ‘κ·Όκ¶ν•μ΄ μλ” μ§€ λ“±λ“±.. )
    - I/O μ™„λ£ μ‹ μ μ–΄κ¶μ„ μ‹μ¤ν…μ½ λ‹¤μ λ…λ ΉμΌλ΅ μ®κΉ€(λλ‚λ©΄ hardware μΈν„°λ½νΈκ°€ κ±Έλ¦Ό, λ‹¤ λλ‚¬λ‹¤κ³ ~)
        - IO μ”μ²­μ„ ν•  λ•λ” μ†ν”„νΈμ›¨μ–΄ μΈν„°λ½νΈλ¥Ό ν†µν•΄μ„ μ”μ²­μ„ ν•κ³  IO λ‹¤ λλ‚λ©΄ ν•λ“μ›¨μ–΄ μΈν„°λ½νΈλ¥Ό ν†µν•΄ λ‹¤ λλ‚¬λ‹¤λ” μ‚¬μ‹¤μ„ μ•λ¦Ό.

# μΈν„°λ½νΈ

- μΈν„°λ½νΈ λ‹Ήν• μ‹μ μ λ μ§€μ¤ν„°μ™€ program counter λ¥Ό save ν• ν›„ CPUμ μ μ–΄λ¥Ό μΈν„°λ½νΈ μ²λ¦¬ λ£¨ν‹΄μ— λ„κΈ΄λ‹¤.
- Interrupt (λ„’μ€ μλ―Έ)
    - interrupt (ν•λ“ μ›¨μ–΄ μΈν„°λ½νΈ): ν•λ“μ›¨μ–΄κ°€ λ°μƒμ‹ν‚¨ μΈν„°λ½νΈ
    - Trap(μ†ν”„νΈμ›¨μ–΄ μΈν„°λ½νΈ)
        - Exception: ν”„λ΅κ·Έλ¨μ΄ μ¤λ¥λ¥Ό λ²”ν• κ²½μ°
        - System call: ν”„λ΅κ·Έλ¨μ΄ μ»¤λ„ ν•¨μλ¥Ό νΈμ¶ν•λ” κ²½μ°

<aside>
π—¨οΈ μΈν„°λ½νΈ λ°±ν„° : ν•΄λ‹Ή μΈν„°λ½νΈμ μ²λ¦¬ λ£¨ν‹΄ μ£Όμ†λ¥Ό κ°€μ§€κ³  μμ

μΈν„°λ½νΈ μ²λ¦¬ λ£¨ν‹΄(Interrupt Service Routine, μΈν„°λ½νΈ ν•Έλ“¤λ¬) : ν•΄λ‹Ή μΈν„°λ½νΈλ¥Ό μ²λ¦¬ν•λ” μ»¤λ„ ν•¨μ

</aside>

κ°€λ Ή, ν‚¤λ³΄λ“ μ»¨νΈλ΅¤λ¬κ°€ μΈν„°λ½νΈλ¥Ό κ±Έμ–΄μ¤λ©΄ ν‚¤λ³΄λ“ λ²„νΌμ— μλ” λ‚΄μ©μ„ λ©”λ¨λ¦¬λ΅ μΉ΄ν”Όν•κ³  ν‚¤λ³΄λ“ ioλ¥Ό μ”μ²­ν• ν”„λ΅μ„Έμ¤ν•ν… cpuλ¥Ό μ–»μ„ μ μλ‹¤λΌλ” κ²ƒμ„ ν‘μ‹ν•΄μ•Όν•  κ²ƒμ΄κ³ , νƒ€μ΄λ¨Έκ°€ μΈν„°λ½νΈλ¥Ό κ±Έμ–΄μ¤λ©΄ cpuλ¥Ό λΊμ•„μ„ λ‹¤λ¥Έ ν”„λ΅μ„Έμ¤μ— μ¤μ•Όν•  κ²ƒμ΄λ‹¤. μΈν„°λ½νΈμ μΆ…λ¥κ°€ μ—¬λ¬κ°κ°€ μλ” λ° κ·Έ μΈν„°λ½νΈ μΆ…λ¥λ§λ‹¤ ν•΄μ•Όν•  μΌλ“¤μ΄ λ‹¤λ¥΄λ‹¤. κ·Έλ ‡κΈ° λ•λ¬Έμ— κ°κ°μ μΈν„°λ½νΈμ μΆ…λ¥λ§λ‹¤ λ¬΄μ¨μΌμ„ ν•΄μ•Όν•λ” μ§€ μ΄μμ²΄μ  μ½”λ“μ— μ •μκ°€ λμ–΄μλ‹¤. μ¦‰ μ΄μμ²΄μ λ¥Ό λ§λ“¤ λ• μ–΄λ–¤ μΈν„°λ½νΈκ°€ λ“¤μ–΄μ¬ λ• μ–΄λ–¤ μΌμ„ ν•΄μ•Όν•λ” μ§€ λ―Έλ¦¬ μ •μκ°€ λμ–΄μλ‹¤. κ° μΈν„°λ½νΈ λ§λ‹¤ μ²λ¦¬ν•΄μ•Όλ  μ‹¤μ  μ½”λ“λ¥Ό μΈν„°λ½νΈ μ²λ¦¬ λ£¨ν‹΄ λΌκ³  λ¶€λ¦„. μΈν„°λ½νΈκ°€ λ“¤μ–΄μ™”γ…‡λ¥΄ λ• κ°€λ Ή 1λ² μΈν„°λ½νΈ ? β†’ μ΄ ν•¨μ, 2λ² μΈν„°λ½νΈ β†’ μ΄ ν•¨μ μ‹¤ν–‰ λ“±λ“± ν•  μ μλ„λ΅ ν•¨. μ΄λ• κ° μ‹¤ν–‰ν•  μ μλ„λ΅ ν•λ” ν•¨μμ μ£Όμ†λ¥Ό μΈν„°λ½νΈ λ°±ν„°λΌκ³  ν•¨.